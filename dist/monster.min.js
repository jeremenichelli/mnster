!function(e,n){"use strict";"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n:e.monster=n(e)}(this,function(e){"use strict";var n={},t=/^(mns-)/,o=/(\-[a-zA-Z0-9]+)+/,r=function(e,n){for(var t=n.split("."),o=e,r=0,l=t.length;l>r;r++){if("undefined"==typeof o[t[r]]||null===o[t[r]])return null;o=o[t[r]]}return o},l=function(n){var t=this;t.template=n.template,t.model={},t.model[n.context]=n.model,t.controller=n.controller||e,t.bindModel()};l.prototype.bindModel=function(){var e=this,n=0;for(e.nodes=e.template.querySelectorAll("*"),e.bindNode(e.template),n=e.nodes.length;n;)e.bindNode(e.nodes[--n]);n=null},l.prototype.bindNode=function(e){for(var l,i,a,d=this,u=e.attributes,c=u.length;c;)if(l=u[--c],i=l.name,a=i.replace(t,"").replace(o,""),t.test(i)&&n[a])try{n[a]({node:e,attribute:l.name,value:l.value,valueFromModel:r(d.model,l.value),controller:d.controller})}catch(m){console.error(m)}u=c=l=i=a=null},l.prototype.update=function(){var e=this,n=0;for(e.bindNode(e.template),n=e.nodes.length;n;)e.bindNode(e.nodes[--n]);n=null};var i=function(e,n){if(!e||!e.nodeType||1!==e.nodeType)throw new Error("monster.view: You must pass a valid template as a first argument");if(!n||!n.context||!n.model)throw new Error("monster.view: You must specify a context and a model");var t=new l({template:e,context:n.context,model:n.model,controller:n.controller});return t},a=function(e,t){if("string"!=typeof e)throw new Error("monster.binding: name must be a string");if("function"!=typeof t)throw new Error("monster.binding: you must specify a method");if(n[e])throw new Error("monster.binding: a binding with this name already exists");n[e]=t},d=function(e){if("string"!=typeof e)throw new Error("monster.clean: name must be a string");n[e]&&(n[e]=null)};return a("text",function(e){var n=e.node,t=e.valueFromModel;n.innerHTML=null!==t?t+"":""}),a("attr",function(e){var n=e.node,t=e.attribute.replace("mns-attr-",""),o=e.valueFromModel;null!==o&&n.setAttribute(t,o+"")}),a("data",function(e){var n=e.node,t=e.attribute.replace("mns-",""),o=e.valueFromModel;null!==o&&n.setAttribute(t,o+"")}),a("show",function(e){e.node.style.display=e.valueFromModel?"block":"none"}),a("hide",function(e){e.node.style.display=e.valueFromModel?"none":"block"}),a("on",function(e){function n(e,n,t){"addEventListner"in document.body?e.addEventListener(n,t,!1):"attachEvent"in document.body?e.attachEvent(n,t):e["on"+n]=t}var t=e.controller[e.value],o=e.attribute.replace("mns-on-","");"function"==typeof t&&n(e.node,o,t)}),a("each",function(e){var n,t,o,r,i=e.node,a=e.valueFromModel,d=e.attribute.replace("mns-each-","");i.__monsterEachTemplate__||(i.__monsterEachTemplate__=document.createElement("div"),i.__monsterEachTemplate__.innerHTML=i.innerHTML),i.innerHTML="";for(var u in a)a.hasOwnProperty(u)&&(o=document.createElement("div"),o.innerHTML=i.__monsterEachTemplate__.innerHTML,n=a[u]||{},t=new l({template:o,context:d,model:n}),i.innerHTML+=o.innerHTML);n=o=t=r=null}),{view:i,binding:a,clean:d}});